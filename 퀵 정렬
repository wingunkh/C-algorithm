/*퀵 정렬이란?
: 일반적으로 사용되고 있는 아주 빠른 정렬 알고리즘.
먼저 한 기준을 선택하고 그 기준보다 작은 그룹과 큰 그룹으로 나눈다.
이때 이 기준을 피벗(pivot)이라고 한다.
퀵 정렬은 이렇게 각 그룹에 대해 피벗설정과 그룹나눔을 반복하며 모든 그룹의 요소가 1개가 되면 정렬을 마친다.
*/

#include <stdio.h>
#include <stdlib.h>

#define swap(type,x,y) do {type t=x; x=y; y=t;} while(0)

void partition(int a[],int n){
	int pl=0;
	int pr=n-1;
	int x=a[n/2];
	
	do{
		while(a[pl]<x) pl++; //a[pl]이 피벗보다 크거나 같을 때 까지 탐색.
		while(a[pr]>x) pr--; //a[pr]이 피벗보다 작거나 같을 때 까지 탐색.
		if(pl<=pr){
			swap(int,a[pl],a[pr]);
			pl++; 
			pr--;
		}
	}while(pl<=pr); //pl과 pr이 교차하면 do while문이 종료됨.
	
	printf("피벗의 값은 %d입니다.\n",x);
	
	printf("피벗 이하의 그룹\n");
	for(int i=0;i<=pl-1;i++){
		printf("%d",a[i]);
	}
	printf("\n");
	
	if(pl>pr+1){
		printf("피벗과 일치하는 그룹\n");
		for(int i=pr+1;i<=pl-1;i++){
			printf("%d",a[i]);
		}
		printf("\n");
	}
	
	printf("피벗 이상의 그룹\n");
	for(int i=pr+1;i<n;i++){
		printf("%d",a[i]);
	}
	printf("\n");
}

int main(void){
	int nx;
	int *x;
	
	printf("배열의 나눕니다.\n");
	printf("요소 개수: ");
	scanf("%d",&nx);
	
	x=malloc(sizeof(int)*nx);
	
	for(int i=0;i<nx;i++){
		printf("x[%d]: ",i);
		scanf("%d",&x[i]);
	}
	
	partition(x,nx);
	free(x);
	
	return 0;
}
